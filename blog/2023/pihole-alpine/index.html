<!DOCTYPE html>
<html><head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <link rel="stylesheet" href="/style.css">
    <link href="https://iosevka-webfonts.github.io/iosevka/iosevka.css" rel="stylesheet" />
    
    
    
    <title>r4sso.github.io | Deploy pihole &#43; unbound on alpine</title>
    <link rel="icon" type="image/x-icon" href="/images/logo.svg">
    <script>
        
        if (
          localStorage.getItem('color-theme') === 'dark' ||
          (!('color-theme' in localStorage) &&
            window.matchMedia('(prefers-color-scheme: dark)').matches)
        ) {
          document.documentElement.classList.add('dark');
        } else {
          document.documentElement.classList.remove('dark');
        }
      </script>
</head><body class="bg-light dark:bg-dark"><nav class="navbar fixed top-0 w-full z-50  dark:navbar-dark">
  <div class="mx-auto max-w-7xl px-2 sm:px-6 lg:px-8">
    <div class="relative flex h-14 items-center justify-between">
      <div class="absolute inset-y-0 left-0 flex items-center md:hidden">
        
        <button type="button" class="inline-flex items-center justify-center rounded-md p-2 text-gray-400 hover:bg-gray-700 hover:text-white focus:outline-none focus:ring-2 focus:ring-inset focus:ring-white" aria-controls="mobile-menu" aria-expanded="false">
          <span class="sr-only">Open main menu</span>
          
          <svg class="block h-6 w-6" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true">
            <path stroke-linecap="round" stroke-linejoin="round" d="M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5" />
          </svg>
          
          <svg class="hidden h-6 w-6" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true">
            <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />
          </svg>
        </button>
      </div>
      <div class="absolute left-11 flex items-center ">
        <button id="theme-toggle" type="button" class="text-gray-500 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-blue-200 dark:focus:ring-yellow-700 rounded-full text-sm p-2.5">
          <svg id="theme-toggle-dark-icon" class="hidden w-5 h-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z"></path></svg>
          <svg id="theme-toggle-light-icon" class="hidden w-5 h-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M10 2a1 1 0 011 1v1a1 1 0 11-2 0V3a1 1 0 011-1zm4 8a4 4 0 11-8 0 4 4 0 018 0zm-.464 4.95l.707.707a1 1 0 001.414-1.414l-.707-.707a1 1 0 00-1.414 1.414zm2.12-10.607a1 1 0 010 1.414l-.706.707a1 1 0 11-1.414-1.414l.707-.707a1 1 0 011.414 0zM17 11a1 1 0 100-2h-1a1 1 0 100 2h1zm-7 4a1 1 0 011 1v1a1 1 0 11-2 0v-1a1 1 0 011-1zM5.05 6.464A1 1 0 106.465 5.05l-.708-.707a1 1 0 00-1.414 1.414l.707.707zm1.414 8.486l-.707.707a1 1 0 01-1.414-1.414l.707-.707a1 1 0 011.414 1.414zM4 11a1 1 0 100-2H3a1 1 0 000 2h1z" fill-rule="evenodd" clip-rule="evenodd"></path></svg>
        </button>
      </div>
      <div class="flex flex-1 items-end justify-end md:items-stretch md:justify-start">
        <div class="flex flex-shrink-0 items-center">
          <a class="navbar-brand" href="https://r4sso.github.io">
            <img class="h-12 w-auto " src="/images/logo.svg" alt="r4sso.github.io">
          </a>
        </div>
   
      </div>
      <div class="absolute inset-y-0 right-0 flex items-center pr-2 sm:static sm:inset-auto sm:ml-6 sm:pr-0  hidden md:block">
        
        <div class="flex space-x-4">
          
          
          
            <a class="hover:text-blue-500 px-1 py-2  text-sm font-medium dark:text-white active underline decoration-2 underline-offset-4 decoration-blue-500" href="https://r4sso.github.io/blog/">Blog</a>
          
            <a class="hover:text-blue-500 px-1 py-2  text-sm font-medium " href="https://r4sso.github.io/notes/">Notes</a>
          
            <a class="hover:text-blue-500 px-1 py-2  text-sm font-medium " href="https://r4sso.github.io/gallery/">Gallery</a>
          
            <a class="hover:text-blue-500 px-1 py-2  text-sm font-medium " href="https://r4sso.github.io/about/">About</a>
          
        </div>
    </div>
  </div>

  
  <div class="hidden" id="mobile-menu">
    <div class="space-y-1 px-2 pt-2 pb-3">
      
      
      
      
      <div class="relative group">

          <a class="hover:text-blue-500 rounded-md block rounded-md px-3 py-2 text-base font-medium active bg-gray-900 text-white dark:text-black dark:bg-white hover:text-white " href="https://r4sso.github.io/blog/">Blog</a>
      
      <div class="relative group">

          <a class="hover:text-blue-500 rounded-md block rounded-md px-3 py-2 text-base font-medium " href="https://r4sso.github.io/notes/">Notes</a>
      
      <div class="relative group">

          <a class="hover:text-blue-500 rounded-md block rounded-md px-3 py-2 text-base font-medium " href="https://r4sso.github.io/gallery/">Gallery</a>
      
      <div class="relative group">

          <a class="hover:text-blue-500 rounded-md block rounded-md px-3 py-2 text-base font-medium " href="https://r4sso.github.io/about/">About</a>
      
 
    </div>
  </div>
</nav>

<main id="main">
                
<div class="pt-16">
    <div class="prose prose-headings:-mb-px  prose-hr:-my-px prose-hr:my-2 mx-auto dark:prose-invert post-card dark:post-card-dark p-8 rounded-lg shadow-2xl shadow-slate-700/10 ring-1 ring-gray-900/5  max-w-4xl">
        <h1 class="-mb-px  text-2xl font-bold">Deploy pihole &#43; unbound on alpine</h1>
        <p class="mt-2 text-sm text-gray-400">Published on Tuesday, 11 Jul 2023</p>
        


<a class="-mt-8 text-gray-600 text-sm underline underline-offset-4 decoration-2 decoration-gray-400 dark:text-gray-500" href="https://r4sso.github.io/tags/docker">docker</a>


<a class="-mt-8 text-gray-600 text-sm underline underline-offset-4 decoration-2 decoration-gray-400 dark:text-gray-500" href="https://r4sso.github.io/tags/pihole">pihole</a>


<a class="-mt-8 text-gray-600 text-sm underline underline-offset-4 decoration-2 decoration-gray-400 dark:text-gray-500" href="https://r4sso.github.io/tags/alpine">alpine</a>


        <hr class="-my-px my-4 h-0.5 bg-gray-200 border-0 dark:bg-gray-700 w-6/12 ">
        <img class="object-cover object-center mx-auto -mb-px max-h-fit w-auto rounded-md" src="https://i.imgur.com/KCpToL8.png" id="thumb-image">
        <div class="article mt-0 text-sm leading-normal">
        <h2 id="what-is-pihole">What is pihole?</h2>
<p>Pi-hole is a Linux network-level advertisement and Internet tracker blocking application which acts as a DNS sinkhole and optionally a DHCP server, intended for use on a private network.It works by intercepting DNS requests made by devices on your network and blocking requests to domains you provide on the <a href="https://firebog.ne">adlist</a> such as (.eg.,advertisements/tracking/phishing domains.)</p>
<h2 id="what-is-unbound">What is unbound?</h2>
<p>Unbound is a validating, recursive, caching DNS resolver. It is designed to resolve domain names by starting from the root DNS servers and recursively traversing the DNS hierarchy until it obtains the final IP address associated with a domain.</p>
<hr>
<h3 id="enable-community-repository">Enable community repository</h3>
<p>Use editor of your choice &amp; uncomment community repository in <code>/etc/apk/repositories</code></p>
<div class="highlight"><pre tabindex="0" style="color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic">#/media/cdrom/apks</span>
</span></span><span style="display:flex;"><span>https://ap.edge.kernel.org/alpine/v3.17/main
</span></span><span style="display:flex;"><span>https://ap.edge.kernel.org/alpine/v3.17/community
</span></span></code></pre></div><h3 id="install-docker--docker-compose">Install docker + docker-compose</h3>
<div class="highlight"><pre tabindex="0" style="color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>apk update
</span></span><span style="display:flex;"><span>apk add docker docker-cli-compose
</span></span></code></pre></div><h3 id="create-docker-composeyaml">Create <code>docker-compose.yaml</code></h3>
<p>The configuration below uses <a href="https://docs.docker.com/network/drivers/macvlan/">macvlan</a> network driver. This allows you to assign different IP addresses and set your own without using the same IP as the host machine.</p>
<p>If you want to change the IP address, ensure that you set the <code>FTLCONF_LOCAL_IPV4</code> to match your IP of your Pi-hole you just set, and change <code>PIHOLE_DNS_</code> to your unbound IP (.e.g, 192.168.0.6#53).<br>
<strong>Make sure to use the <code>#</code> symbol to specify the ports.</strong></p>
<p>Please refer to the documentation for more details: <a href="https://github.com/pi-hole/docker-pi-hole">github.com/pi-hole/docker-pi-hole</a></p>
<div class="highlight"><pre tabindex="0" style="color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-docker" data-lang="docker"><span style="display:flex;"><span>version: <span style="color:#a5d6ff">&#34;3&#34;</span><span style="color:#f85149">
</span></span></span><span style="display:flex;"><span><span style="color:#f85149">
</span></span></span><span style="display:flex;"><span><span style="color:#f85149"></span><span style="color:#8b949e;font-style:italic"># More info at https://github.com/pi-hole/docker-pi-hole/ and https://docs.pi-hole.net/</span><span style="color:#f85149">
</span></span></span><span style="display:flex;"><span><span style="color:#f85149"></span>services:<span style="color:#f85149">
</span></span></span><span style="display:flex;"><span><span style="color:#f85149"></span>  pihole:<span style="color:#f85149">
</span></span></span><span style="display:flex;"><span><span style="color:#f85149"></span>    container_name: pihole<span style="color:#f85149">
</span></span></span><span style="display:flex;"><span><span style="color:#f85149"></span>    image: pihole/pihole:latest<span style="color:#f85149">
</span></span></span><span style="display:flex;"><span><span style="color:#f85149"></span>    <span style="color:#8b949e;font-style:italic"># For DHCP it is recommended to remove these ports and instead add: network_mode: &#34;host&#34;</span><span style="color:#f85149">
</span></span></span><span style="display:flex;"><span><span style="color:#f85149"></span>    ports:<span style="color:#f85149">
</span></span></span><span style="display:flex;"><span><span style="color:#f85149"></span>      - <span style="color:#a5d6ff">&#34;53:53/tcp&#34;</span><span style="color:#f85149">
</span></span></span><span style="display:flex;"><span><span style="color:#f85149"></span>      - <span style="color:#a5d6ff">&#34;53:53/udp&#34;</span><span style="color:#f85149">
</span></span></span><span style="display:flex;"><span><span style="color:#f85149"></span>      - <span style="color:#a5d6ff">&#34;67:67/udp&#34;</span> <span style="color:#8b949e;font-style:italic"># Only required if you are using Pi-hole as your DHCP server</span><span style="color:#f85149">
</span></span></span><span style="display:flex;"><span><span style="color:#f85149"></span>      - <span style="color:#a5d6ff">&#34;80:80/tcp&#34;</span><span style="color:#f85149">
</span></span></span><span style="display:flex;"><span><span style="color:#f85149"></span>    environment:<span style="color:#f85149">
</span></span></span><span style="display:flex;"><span><span style="color:#f85149"></span>      TZ: <span style="color:#a5d6ff">&#39;Asia/Singapore&#39;</span><span style="color:#f85149">
</span></span></span><span style="display:flex;"><span><span style="color:#f85149"></span>      WEBPASSWORD: <span style="color:#a5d6ff">&#39;&#39;</span> <span style="color:#8b949e;font-style:italic"># set a secure password here or it will be random</span><span style="color:#f85149">
</span></span></span><span style="display:flex;"><span><span style="color:#f85149"></span>      FTLCONF_LOCAL_IPV4: 192.168.0.5<span style="color:#f85149">
</span></span></span><span style="display:flex;"><span><span style="color:#f85149"></span>      PIHOLE_DNS_: <span style="color:#a5d6ff">&#39;192.168.0.6#53&#39;</span><span style="color:#f85149">
</span></span></span><span style="display:flex;"><span><span style="color:#f85149"></span>      DNSSEC: true<span style="color:#f85149">
</span></span></span><span style="display:flex;"><span><span style="color:#f85149"></span>      RATE_LIMIT: 1/3600<span style="color:#f85149">
</span></span></span><span style="display:flex;"><span><span style="color:#f85149"></span>    <span style="color:#8b949e;font-style:italic"># Volumes store your data between container upgrades</span><span style="color:#f85149">
</span></span></span><span style="display:flex;"><span><span style="color:#f85149"></span>    volumes:<span style="color:#f85149">
</span></span></span><span style="display:flex;"><span><span style="color:#f85149"></span>      - <span style="color:#a5d6ff">&#39;./etc-pihole:/etc/pihole&#39;</span><span style="color:#f85149">
</span></span></span><span style="display:flex;"><span><span style="color:#f85149"></span>      - <span style="color:#a5d6ff">&#39;./etc-dnsmasq.d:/etc/dnsmasq.d&#39;</span><span style="color:#f85149">
</span></span></span><span style="display:flex;"><span><span style="color:#f85149"></span>    <span style="color:#8b949e;font-style:italic">#   https://github.com/pi-hole/docker-pi-hole#note-on-capabilities</span><span style="color:#f85149">
</span></span></span><span style="display:flex;"><span><span style="color:#f85149"></span>    cap_add:<span style="color:#f85149">
</span></span></span><span style="display:flex;"><span><span style="color:#f85149"></span>      - NET_ADMIN <span style="color:#8b949e;font-style:italic"># Required if you are using Pi-hole as your DHCP server, else not needed</span><span style="color:#f85149">
</span></span></span><span style="display:flex;"><span><span style="color:#f85149"></span>    networks:<span style="color:#f85149">
</span></span></span><span style="display:flex;"><span><span style="color:#f85149"></span>      home:<span style="color:#f85149">
</span></span></span><span style="display:flex;"><span><span style="color:#f85149"></span>        ipv4_address: 192.168.0.5<span style="color:#f85149">
</span></span></span><span style="display:flex;"><span><span style="color:#f85149"></span>    restart: unless-stopped<span style="color:#f85149">
</span></span></span><span style="display:flex;"><span><span style="color:#f85149"></span>   <span style="color:#f85149">
</span></span></span><span style="display:flex;"><span><span style="color:#f85149"></span>  unbound:<span style="color:#f85149">
</span></span></span><span style="display:flex;"><span><span style="color:#f85149"></span>    container_name: unbound<span style="color:#f85149">
</span></span></span><span style="display:flex;"><span><span style="color:#f85149"></span>    image: mvance/unbound:latest<span style="color:#f85149">
</span></span></span><span style="display:flex;"><span><span style="color:#f85149"></span>    ports:<span style="color:#f85149">
</span></span></span><span style="display:flex;"><span><span style="color:#f85149"></span>      - <span style="color:#a5d6ff">&#34;53:53/tcp&#34;</span><span style="color:#f85149">
</span></span></span><span style="display:flex;"><span><span style="color:#f85149"></span>      - <span style="color:#a5d6ff">&#34;53:53/udp&#34;</span><span style="color:#f85149">
</span></span></span><span style="display:flex;"><span><span style="color:#f85149"></span>    networks:<span style="color:#f85149">
</span></span></span><span style="display:flex;"><span><span style="color:#f85149"></span>      home:<span style="color:#f85149">
</span></span></span><span style="display:flex;"><span><span style="color:#f85149"></span>        ipv4_address: 192.168.0.6<span style="color:#f85149">
</span></span></span><span style="display:flex;"><span><span style="color:#f85149"></span>    restart: always<span style="color:#f85149">
</span></span></span><span style="display:flex;"><span><span style="color:#f85149"></span>    <span style="color:#f85149">
</span></span></span><span style="display:flex;"><span><span style="color:#f85149">
</span></span></span><span style="display:flex;"><span><span style="color:#f85149"></span>networks:<span style="color:#f85149">
</span></span></span><span style="display:flex;"><span><span style="color:#f85149"></span>  home:<span style="color:#f85149">
</span></span></span><span style="display:flex;"><span><span style="color:#f85149"></span>    driver: macvlan<span style="color:#f85149">
</span></span></span><span style="display:flex;"><span><span style="color:#f85149"></span>    driver_opts:<span style="color:#f85149">
</span></span></span><span style="display:flex;"><span><span style="color:#f85149"></span>      parent: eth0<span style="color:#f85149">
</span></span></span><span style="display:flex;"><span><span style="color:#f85149"></span>    ipam:<span style="color:#f85149">
</span></span></span><span style="display:flex;"><span><span style="color:#f85149"></span>      config:<span style="color:#f85149">
</span></span></span><span style="display:flex;"><span><span style="color:#f85149"></span>        - subnet: 192.168.0.0/24<span style="color:#f85149">
</span></span></span><span style="display:flex;"><span><span style="color:#f85149"></span>          gateway: 192.168.0.1<span style="color:#f85149">
</span></span></span><span style="display:flex;"><span><span style="color:#f85149"></span>          ip_range: 192.168.0.5/30 <span style="color:#8b949e;font-style:italic"># 192.168.0.5 and 192.168.0.6</span><span style="color:#f85149">
</span></span></span></code></pre></div><p>The IP addresses set above are as follows:</p>
<ul>
<li>Pi-hole: 192.168.0.5</li>
<li>Unbound: 192.168.0.6</li>
</ul>
<p>Start the Docker container:</p>
<div class="highlight"><pre tabindex="0" style="color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>docker-compose up -d
</span></span></code></pre></div><p>http://[your_pihole_ip]/admin</p>
        
        <hr>
        <p class="-mb-2 text-sm text-right">Last edited: <b>11/07/2023 07:10 UTC</b></p>
        </div>
    </div>

  <footer class="grid justify-center relative text-center p-8">
    <span class="items-start text-sm text-gray-500">&copy; 2023 <b><a href="https://r4sso.github.io">r4sso.github.io</a></b></span>
</footer>

</div>

                <button id="scroll-to-top" class="fixed bottom-8 right-8 bg-gray-700 hover:bg-gray-800 text-white rounded-full p-4 hidden" onclick="scrollToTop()">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-up w-6 h-6">
      <path d="M18 15l-6-6-6 6" />
    </svg>
</button>
  
<script>
    
</script>
  
            </main>
        
<script src="/js/script.js"></script>
<script src="/js/copy-button.js"></script>

    </body>
</html>